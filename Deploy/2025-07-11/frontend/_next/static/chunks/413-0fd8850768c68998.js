"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[413],{1886:(e,t,a)=>{a.d(t,{$j:()=>n,LG:()=>s,V8:()=>o,gx:()=>i,sZ:()=>l});class s extends Error{constructor(e,t,a){super(t),this.status=e,this.errorData=a,this.name="APIError",a&&Object.assign(this,a)}}async function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="".concat("https://www.apanner.com").concat(e),r=await fetch(a,{headers:{"Content-Type":"application/json",...t.headers},...t});if(!r.ok){let e=await r.json().catch(()=>({}));throw new s(r.status,e.error||"Request failed",e)}return r.json()}let o={createGame:async e=>r("/api/create",{method:"POST",body:JSON.stringify(e)}),joinGame:async(e,t)=>r("/api/join",{method:"POST",body:JSON.stringify({code:e,playerName:t})}),getGameState:async e=>r("/api/game/".concat(e)),startGame:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"startGame"})}),submitBid:async(e,t,a)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"submitBid",data:{bid:a}})}),submitTricks:async(e,t,a)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"submitTricks",data:{tricks:a}})}),nextRound:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"nextRound"})}),startTrickTracking:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"startTrickTracking"})}),completeRound:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"completeRound"})}),leaveGame:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"leaveGame"})}),deleteGame:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"deleteGame"})}),cancelGame:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"cancelGame"})}),editPlayerTricks:async(e,t,a,s)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"editPlayerTricks",data:{targetPlayerId:a,newTricks:s}})}),approveTricks:async(e,t)=>r("/api/action",{method:"POST",body:JSON.stringify({gameId:e,playerId:t,action:"approveTricks"})}),async getGame(e){return this.getGameState(e)}};class n{getPollingInterval(e){switch(e){case"lobby":default:return 3e3;case"bidding":case"playing":return 1e3;case"scoring":return 2e3;case"completed":return 5e3}}startPolling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"lobby";this.stopPolling(),this.currentInterval=this.getPollingInterval(t);let a=async()=>{try{let t=(await o.getGameState(e)).game,a=this.getPollingInterval(t.status);if(a!==this.currentInterval){this.currentInterval=a,this.startPolling(e,t.status);return}this.callbacks.forEach(e=>e(t))}catch(e){console.error("Polling error:",e),this.errorCallbacks.forEach(t=>t(e)),this.currentInterval=Math.min(1.5*this.currentInterval,1e4)}};a(),this.intervalId=setInterval(a,this.currentInterval)}stopPolling(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}onGameUpdate(e){this.callbacks.push(e)}onError(e){this.errorCallbacks.push(e)}removeGameUpdate(e){this.callbacks=this.callbacks.filter(t=>t!==e)}removeError(e){this.errorCallbacks=this.errorCallbacks.filter(t=>t!==e)}clearCallbacks(){this.callbacks=[],this.errorCallbacks=[]}constructor(){this.intervalId=null,this.currentInterval=3e3,this.callbacks=[],this.errorCallbacks=[]}}let i={getTeamMembers:(e,t)=>Object.values(e.players).filter(e=>e.team===t),getCurrentRound:e=>0===e.currentRound?null:e.rounds[e.currentRound-1]||null,hasPlayerBid(e,t){let a=this.getCurrentRound(e);return!!a&&t in a.bids},hasPlayerTricks(e,t){let a=this.getCurrentRound(e);return!!a&&t in a.tricks},getTeamRoundScore(e,t){let a=this.getCurrentRound(e);return a?Object.entries(e.players).filter(e=>{let[a,s]=e;return s.team===t}).reduce((e,t)=>{let[s,r]=t;return e+(a.scores[s]||0)},0):0},getWinningTeam:e=>"completed"!==e.status?null:e.scores.red>e.scores.blue?"red":e.scores.blue>e.scores.red?"blue":"tie",formatGameCode:e=>e.toUpperCase().split("").join(" ")},l={savePlayerSession(e,t,a){let s={gameId:e,playerId:t,playerName:a,timestamp:Date.now()};console.log("\uD83D\uDD10 Saving session:",s);try{localStorage.setItem("spadeSync_session",JSON.stringify(s)),console.log("✅ Session saved to localStorage")}catch(e){console.warn("⚠️ localStorage save failed:",e)}try{window.sessionStorage.setItem("spadeSync_session",JSON.stringify(s)),console.log("✅ Session saved to sessionStorage")}catch(e){console.warn("⚠️ sessionStorage save failed:",e)}try{if(window.history&&window.history.replaceState){let s=new URL(window.location.href);s.searchParams.set("sid",btoa(JSON.stringify({gameId:e,playerId:t,playerName:a}))),window.history.replaceState({},"",s),console.log("✅ Session saved to URL params")}}catch(e){console.warn("⚠️ URL params save failed:",e)}try{window.spadeSync_session=s,console.log("✅ Session saved to global variable")}catch(e){console.warn("⚠️ Global variable save failed:",e)}},savePlayerName(e){let t=this.getPlayerSession(),a={gameId:(null==t?void 0:t.gameId)||"",playerId:(null==t?void 0:t.playerId)||"",playerName:e,timestamp:Date.now()};console.log("\uD83D\uDD10 Saving player name:",e);try{localStorage.setItem("spadeSync_session",JSON.stringify(a))}catch(e){console.warn("⚠️ localStorage save failed for player name:",e)}try{window.sessionStorage.setItem("spadeSync_session",JSON.stringify(a))}catch(e){console.warn("⚠️ sessionStorage save failed for player name:",e)}},getPlayerSession(){console.log("\uD83D\uDD0D Retrieving session...");try{let e=localStorage.getItem("spadeSync_session");if(e){let t=JSON.parse(e);if(Date.now()-t.timestamp<144e5)return console.log("✅ Session found in localStorage:",t),t;console.log("⏰ Session expired in localStorage")}}catch(e){console.warn("⚠️ localStorage retrieval failed:",e)}try{let e=window.sessionStorage.getItem("spadeSync_session");if(e){let t=JSON.parse(e);if(Date.now()-t.timestamp<144e5)return console.log("✅ Session found in sessionStorage:",t),t;console.log("⏰ Session expired in sessionStorage")}}catch(e){console.warn("⚠️ sessionStorage retrieval failed:",e)}try{{let e=new URL(window.location.href).searchParams.get("sid");if(e){let t=JSON.parse(atob(e));return console.log("✅ Session found in URL params:",t),t}}}catch(e){console.warn("⚠️ URL params retrieval failed:",e)}try{if(window.spadeSync_session){let e=window.spadeSync_session;if(Date.now()-e.timestamp<144e5)return console.log("✅ Session found in global variable:",e),e;console.log("⏰ Session expired in global variable")}}catch(e){console.warn("⚠️ Global variable retrieval failed:",e)}return console.log("❌ No valid session found"),null},clearPlayerSession(){console.log("\uD83D\uDDD1️ Clearing session from all locations...");try{localStorage.removeItem("spadeSync_session"),console.log("✅ Session cleared from localStorage")}catch(e){console.warn("⚠️ localStorage clear failed:",e)}try{window.sessionStorage.removeItem("spadeSync_session"),console.log("✅ Session cleared from sessionStorage")}catch(e){console.warn("⚠️ sessionStorage clear failed:",e)}try{if(window.history&&window.history.replaceState){let e=new URL(window.location.href);e.searchParams.delete("sid"),window.history.replaceState({},"",e),console.log("✅ Session cleared from URL params")}}catch(e){console.warn("⚠️ URL params clear failed:",e)}try{delete window.spadeSync_session,console.log("✅ Session cleared from global variable")}catch(e){console.warn("⚠️ Global variable clear failed:",e)}}}},2714:(e,t,a)=>{a.d(t,{J:()=>c});var s=a(5155),r=a(2115),o=a(2797),n=a(2085),i=a(3999);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(o.b,{ref:t,className:(0,i.cn)(l(),a),suppressHydrationWarning:!0,...r})});c.displayName=o.b.displayName},3580:(e,t,a)=>{a.d(t,{dj:()=>g,oR:()=>u});var s=a(2115);let r=0,o=new Map,n=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?n(a):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],c={toasts:[]};function d(e){c=i(c,e),l.forEach(e=>{e(c)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:a});return d({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function g(){let[e,t]=s.useState(c);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},3999:(e,t,a)=>{a.d(t,{cn:()=>o,m:()=>n});var s=a(2596),r=a(9688);function o(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}function n(e){let t=Math.floor((Date.now()-e)/1e3);if(t<60)return"".concat(t," second").concat(1===t?"":"s");let a=Math.floor(t/60);if(a<60)return"".concat(a," minute").concat(1===a?"":"s");let s=Math.floor(a/60);if(s<24)return"".concat(s," hour").concat(1===s?"":"s");let r=Math.floor(s/24);return"".concat(r," day").concat(1===r?"":"s")}},7168:(e,t,a)=>{a.d(t,{$:()=>c,r:()=>l});var s=a(5155),r=a(2115),o=a(9708),n=a(2085),i=a(3999);let l=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:c=!1,...d}=e,u=c?o.DX:"button";return(0,s.jsx)(u,{className:(0,i.cn)(l({variant:r,size:n,className:a})),ref:t,suppressHydrationWarning:!0,...d})});c.displayName="Button"},8482:(e,t,a)=>{a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>l,Zp:()=>n,aR:()=>i,wL:()=>u});var s=a(5155),r=a(2115),o=a(3999);let n=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),suppressHydrationWarning:!0,...r})});n.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",a),suppressHydrationWarning:!0,...r})});i.displayName="CardHeader";let l=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",a),suppressHydrationWarning:!0,...r})});l.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),suppressHydrationWarning:!0,...r})});c.displayName="CardDescription";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",a),suppressHydrationWarning:!0,...r})});d.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",a),suppressHydrationWarning:!0,...r})});u.displayName="CardFooter"},9852:(e,t,a)=>{a.d(t,{p:()=>n});var s=a(5155),r=a(2115),o=a(3999);let n=r.forwardRef((e,t)=>{let{className:a,type:r,...n}=e;return(0,s.jsx)("input",{type:r,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,suppressHydrationWarning:!0,...n})});n.displayName="Input"}}]);