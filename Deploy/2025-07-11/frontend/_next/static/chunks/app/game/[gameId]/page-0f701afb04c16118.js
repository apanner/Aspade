(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[535],{646:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},1154:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1684:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>w});var a=t(5155),r=t(2115),i=t(5695),n=t(7168),l=t(8482),d=t(9852),c=t(2714),o=t(8145),m=t(3580),u=t(1886),x=t(1154),h=t(7340),p=t(4357),j=t(7951),g=t(646),y=t(7580),v=t(5690),f=t(4186),b=t(2138),N=t(8186);function w(){var e,s;let t=(0,i.useParams)(),w=(0,i.useRouter)(),{toast:k}=(0,m.dj)(),A=t.gameId,R=(0,r.useRef)(null),[B,S]=(0,r.useState)(null),[T,P]=(0,r.useState)(null),[C,M]=(0,r.useState)(!0),[E,W]=(0,r.useState)(!1),[Z,G]=(0,r.useState)(""),[F,H]=(0,r.useState)("");(0,r.useEffect)(()=>((async()=>{try{let e=u.sZ.getPlayerSession();if(!e||e.gameId!==A){w.push("/");return}P(e.playerId);let s=await u.V8.getGameState(A);S(s.game),R.current=new u.$j,R.current.onGameUpdate(e=>{S(e)}),R.current.startPolling(A,s.game.status)}catch(e){console.error("Error initializing game:",e),k({title:"Error",description:"Failed to load game",variant:"destructive"}),w.push("/")}finally{M(!1)}})(),()=>{R.current&&R.current.stopPolling()}),[A,w,k]);let L=async()=>{if(B&&T){W(!0);try{await u.V8.startGame(A,T),k({title:"Game Started!",description:"Time to place your bids"})}catch(e){console.error("Error starting game:",e),k({title:"Error",description:e instanceof u.LG?e.message:"Failed to start game",variant:"destructive"})}finally{W(!1)}}},V=async e=>{if(e.preventDefault(),!B||!T||!Z.trim())return;let s=parseInt(Z.trim());if(isNaN(s)||s<0||s>((null==B?void 0:B.currentRound)||13)){k({title:"Invalid Bid",description:"Bid must be between 0 and ".concat((null==B?void 0:B.currentRound)||13),variant:"destructive"});return}W(!0);try{await u.V8.submitBid(A,T,s),G(""),k({title:"Bid Submitted!",description:"You bid ".concat(s," tricks")})}catch(e){console.error("Error submitting bid:",e),k({title:"Error",description:e instanceof u.LG?e.message:"Failed to submit bid",variant:"destructive"})}finally{W(!1)}},$=async e=>{if(e.preventDefault(),!B||!T||!F.trim())return;let s=parseInt(F.trim());if(isNaN(s)||s<0||s>((null==B?void 0:B.currentRound)||13)){k({title:"Invalid Tricks",description:"Tricks must be between 0 and ".concat((null==B?void 0:B.currentRound)||13),variant:"destructive"});return}W(!0);try{await u.V8.submitTricks(A,T,s),H(""),k({title:"Tricks Submitted!",description:"You won ".concat(s," tricks")})}catch(e){console.error("Error submitting tricks:",e),k({title:"Error",description:e instanceof u.LG?e.message:"Failed to submit tricks",variant:"destructive"})}finally{W(!1)}},z=async()=>{if(B&&T){W(!0);try{await u.V8.nextRound(A,T),k({title:"Next Round!",description:B.currentRound>=B.maxRounds?"Game complete!":"Time for the next round"})}catch(e){console.error("Error advancing round:",e),k({title:"Error",description:e instanceof u.LG?e.message:"Failed to advance round",variant:"destructive"})}finally{W(!1)}}},I=()=>{u.sZ.clearPlayerSession(),w.push("/")};if(C)return(0,a.jsx)("div",{className:"container max-w-md mx-auto p-4 min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(x.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading game..."})]})});if(!B||!T)return(0,a.jsx)("div",{className:"container max-w-md mx-auto p-4 min-h-screen flex items-center justify-center",children:(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Game Not Found"}),(0,a.jsx)(l.BT,{children:"This game may have ended or doesn't exist"})]}),(0,a.jsx)(l.Wu,{children:(0,a.jsxs)(n.$,{onClick:()=>w.push("/"),className:"w-full",children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Go Home"]})})]})});let D=B.players[T],Y=null==D?void 0:D.isHost,_=u.gx.getTeamMembers(B,"red"),q=u.gx.getTeamMembers(B,"blue"),O=u.gx.getCurrentRound(B);return(0,a.jsxs)("div",{className:"container max-w-md mx-auto p-4 min-h-screen",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"SpadeSync Lite"}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Round ",B.currentRound," of ",B.maxRounds]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.E,{variant:"outline",className:"font-mono",children:u.gx.formatGameCode(B.code)}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:()=>{B&&(navigator.clipboard.writeText(B.code),k({title:"Copied!",description:"Game code copied to clipboard"}))},children:(0,a.jsx)(p.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(o.E,{variant:"completed"===B.status?"default":"secondary",children:["lobby"===B.status&&"Waiting for Players","bidding"===B.status&&"Bidding Phase","playing"===B.status&&"Playing Phase","scoring"===B.status&&"Scoring Phase","completed"===B.status&&"Game Complete"]}),(0,a.jsx)(n.$,{variant:"ghost",size:"sm",onClick:I,children:(0,a.jsx)(h.A,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,a.jsxs)(l.Zp,{className:"border-red-200",children:[(0,a.jsx)(l.aR,{className:"pb-3",children:(0,a.jsx)(l.ZB,{className:"text-lg text-red-600",children:"Red Team"})}),(0,a.jsxs)(l.Wu,{className:"space-y-2",children:[_.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name}),e.isHost&&(0,a.jsx)(j.A,{className:"h-3 w-3 text-yellow-500"})]}),O&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[u.gx.hasPlayerBid(B,e.id)&&"lobby"!==B.status&&(0,a.jsx)(g.A,{className:"h-3 w-3 text-green-500"}),u.gx.hasPlayerTricks(B,e.id)&&"playing"===B.status&&(0,a.jsx)(g.A,{className:"h-3 w-3 text-green-500"})]})]},e.id)),(0,a.jsx)("div",{className:"text-xl font-bold text-red-600 pt-2 border-t",children:B.scores.red})]})]}),(0,a.jsxs)(l.Zp,{className:"border-blue-200",children:[(0,a.jsx)(l.aR,{className:"pb-3",children:(0,a.jsx)(l.ZB,{className:"text-lg text-blue-600",children:"Blue Team"})}),(0,a.jsxs)(l.Wu,{className:"space-y-2",children:[q.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:e.name}),e.isHost&&(0,a.jsx)(j.A,{className:"h-3 w-3 text-yellow-500"})]}),O&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[u.gx.hasPlayerBid(B,e.id)&&"lobby"!==B.status&&(0,a.jsx)(g.A,{className:"h-3 w-3 text-green-500"}),u.gx.hasPlayerTricks(B,e.id)&&"playing"===B.status&&(0,a.jsx)(g.A,{className:"h-3 w-3 text-green-500"})]})]},e.id)),(0,a.jsx)("div",{className:"text-xl font-bold text-blue-600 pt-2 border-t",children:B.scores.blue})]})]})]}),"lobby"===B.status&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsxs)(l.ZB,{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-5 w-5"}),"Waiting for Players"]}),(0,a.jsxs)(l.BT,{children:["Need at least 2 players to start. Share code: ",B.code]})]}),(0,a.jsxs)(l.Wu,{children:[Y&&Object.keys(B.players).length>=2&&(0,a.jsx)(n.$,{onClick:L,disabled:E,className:"w-full",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Starting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{className:"mr-2 h-4 w-4"}),"Start Game"]})}),!Y&&(0,a.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,a.jsx)(f.A,{className:"h-6 w-6 mx-auto mb-2"}),(0,a.jsx)("p",{children:"Waiting for host to start the game"})]})]})]}),"bidding"===B.status&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Place Your Bid"}),(0,a.jsxs)(l.BT,{children:["How many tricks do you think you'll win? (0-",(null==B?void 0:B.currentRound)||13,")"]})]}),(0,a.jsx)(l.Wu,{children:u.gx.hasPlayerBid(B,T)?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Bid Submitted!"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["You bid ",null==O?void 0:O.bids[T]," tricks"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Waiting for other players..."})]}):(0,a.jsxs)("form",{onSubmit:V,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"bid",children:"Your Bid"}),(0,a.jsx)(d.p,{id:"bid",type:"number",min:"0",max:(null==B?void 0:null===(e=B.currentRound)||void 0===e?void 0:e.toString())||"13",placeholder:"Enter bid (0-".concat((null==B?void 0:B.currentRound)||13,")"),value:Z,onChange:e=>G(e.target.value),className:"text-center text-lg"})]}),(0,a.jsx)(n.$,{type:"submit",disabled:E,className:"w-full",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Bid"})]})})]}),"playing"===B.status&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Enter Tricks Won"}),(0,a.jsxs)(l.BT,{children:["How many tricks did you actually win? (0-",(null==B?void 0:B.currentRound)||13,")"]})]}),(0,a.jsx)(l.Wu,{children:u.gx.hasPlayerTricks(B,T)?(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(g.A,{className:"h-12 w-12 text-green-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-lg font-medium",children:"Tricks Submitted!"}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:["You won ",null==O?void 0:O.tricks[T]," tricks"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Waiting for other players..."})]}):(0,a.jsxs)("form",{onSubmit:$,className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c.J,{htmlFor:"tricks",children:"Tricks Won"}),(0,a.jsx)(d.p,{id:"tricks",type:"number",min:"0",max:(null==B?void 0:null===(s=B.currentRound)||void 0===s?void 0:s.toString())||"13",placeholder:"Enter tricks won (0-".concat((null==B?void 0:B.currentRound)||13,")"),value:F,onChange:e=>H(e.target.value),className:"text-center text-lg"})]}),(0,a.jsx)(n.$,{type:"submit",disabled:E,className:"w-full",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):"Submit Tricks"})]})})]}),"scoring"===B.status&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{children:["Round ",B.currentRound," Results"]})}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[O&&(0,a.jsx)("div",{className:"space-y-3",children:Object.entries(B.players).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:t.name}),(0,a.jsxs)("span",{className:"ml-2 text-sm ".concat("red"===t.team?"text-red-600":"text-blue-600"),children:["(",t.team,")"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-sm text-muted-foreground",children:["Bid: ",O.bids[s]," | Won: ",O.tricks[s]]}),(0,a.jsxs)("div",{className:"font-bold",children:[O.scores[s]>0?"+":"",O.scores[s]]})]})]},s)})}),Y&&(0,a.jsx)(n.$,{onClick:z,disabled:E,className:"w-full",children:E?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Advancing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4"}),B.currentRound>=B.maxRounds?"Complete Game":"Next Round"]})}),!Y&&(0,a.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,a.jsx)(f.A,{className:"h-6 w-6 mx-auto mb-2"}),(0,a.jsx)("p",{children:"Waiting for host to advance to next round"})]})]})]}),"completed"===B.status&&(0,a.jsxs)(l.Zp,{children:[(0,a.jsx)(l.aR,{children:(0,a.jsxs)(l.ZB,{className:"text-center",children:[(0,a.jsx)(N.A,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),"Game Complete!"]})}),(0,a.jsxs)(l.Wu,{className:"space-y-4",children:[(0,a.jsx)("div",{className:"text-center",children:(()=>{let e=u.gx.getWinningTeam(B);return"tie"===e?(0,a.jsx)("p",{className:"text-lg font-medium",children:"It's a tie!"}):(0,a.jsx)("p",{className:"text-lg font-medium",children:(0,a.jsxs)("span",{className:"red"===e?"text-red-600":"text-blue-600",children:["red"===e?"Red":"Blue"," Team Wins!"]})})})()}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:B.scores.red}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Red Team"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:B.scores.blue}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:"Blue Team"})]})]}),(0,a.jsxs)(n.$,{onClick:I,className:"w-full",children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"New Game"]})]})]})]})}},2138:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},2797:(e,s,t)=>{"use strict";t.d(s,{b:()=>d});var a=t(2115);t(7650);var r=t(9708),i=t(5155),n=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,s)=>{let t=a.forwardRef((e,t)=>{let{asChild:a,...n}=e,l=a?r.DX:s;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,i.jsx)(l,{...n,ref:t})});return t.displayName=`Primitive.${s}`,{...e,[s]:t}},{}),l=a.forwardRef((e,s)=>(0,i.jsx)(n.label,{...e,ref:s,onMouseDown:s=>{var t;s.target.closest("button, input, select, textarea")||(null===(t=e.onMouseDown)||void 0===t||t.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));l.displayName="Label";var d=l},4186:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},4357:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},5690:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},5695:(e,s,t)=>{"use strict";var a=t(8999);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}})},6481:(e,s,t)=>{Promise.resolve().then(t.bind(t,1684))},7340:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},7580:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},7951:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},8145:(e,s,t)=>{"use strict";t.d(s,{E:()=>l});var a=t(5155);t(2115);var r=t(2085),i=t(3999);let n=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)(n({variant:t}),s),suppressHydrationWarning:!0,...r})}},8186:(e,s,t)=>{"use strict";t.d(s,{A:()=>a});let a=(0,t(9946).A)("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[455,413,441,684,358],()=>s(6481)),_N_E=e.O()}]);